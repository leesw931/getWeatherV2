<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ìš°ë¦¬ê°€ì¡± ë‚ ì”¨ì•±</title>
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
</head>
<body>
  <script>
    const password = prompt("ì ‘ì† ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”");
    if (password !== "ìš°ë¦¬ì§‘ë¹„ë²ˆ") {
      document.body.innerHTML = "<h2 style='text-align:center; color:red;'>ì˜ëª»ëœ ì ‘ê·¼ì…ë‹ˆë‹¤.</h2>";
      throw new Error("ì ‘ê·¼ ì°¨ë‹¨");
    }
  </script>

  <div class="container">
    <header>
      <h1>ğŸŒ¤ ìš°ë¦¬ê°€ì¡± ë‚ ì”¨</h1>
      <select id="regionSelect">
        <option value="37.3223,127.0945">ìˆ˜ì§€</option>
        <option value="37.2856,127.0138">ë§ˆì‚°ë™</option>
        <option value="37.3450,126.7351">ë§Œìˆ˜ë¦¬</option>
      </select>
    </header>

    <div class="tab-buttons">
      <button id="nowTab" class="active">Now</button>
      <button id="days10Tab">10 Days</button>
    </div>

    <section id="nowSection">
      <div class="swiper">
        <div class="swiper-wrapper" id="forecastSlides">
          <!-- ì‹œê°„ë³„ ë‚ ì”¨ ìŠ¬ë¼ì´ë“œê°€ ì—¬ê¸°ì— ë“¤ì–´ê° -->
        </div>
      </div>
    </section>

    <section id="days10Section" style="display: none;">
      <div id="days10Container">
        <!-- ì¤‘ê¸°ì˜ˆë³´ ì¹´ë“œ í˜•ì‹ ë“¤ì–´ê°ˆ ìë¦¬ -->
      </div>
    </section>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
  <script>
    const regionSelect = document.getElementById("regionSelect");
    const forecastSlides = document.getElementById("forecastSlides");
    const nowTab = document.getElementById("nowTab");
    const days10Tab = document.getElementById("days10Tab");
    const nowSection = document.getElementById("nowSection");
    const days10Section = document.getElementById("days10Section");

    nowTab.addEventListener("click", () => {
      nowTab.classList.add("active");
      days10Tab.classList.remove("active");
      nowSection.style.display = "block";
      days10Section.style.display = "none";
    });

    days10Tab.addEventListener("click", () => {
      days10Tab.classList.add("active");
      nowTab.classList.remove("active");
      days10Section.style.display = "block";
      nowSection.style.display = "none";
    });

    regionSelect.addEventListener("change", fetchForecast);

    async function fetchForecast() {
      const [lat, lon] = regionSelect.value.split(",");
      const url = `https://api.met.no/weatherapi/locationforecast/2.0/compact?lat=${lat}&lon=${lon}`;

      try {
        const res = await fetch(url, {
          headers: {
            "User-Agent": "my-family-weather/1.0 ta-da@example.com"
          }
        });
        const data = await res.json();
        renderForecast(data.properties.timeseries);
      } catch (err) {
        alert("ë‚ ì”¨ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.");
        console.error(err);
      }
    }

    function renderForecast(timeseries) {
      forecastSlides.innerHTML = "";
      const nextHours = timeseries.slice(0, 6); // ì²« 6ì‹œê°„ë§Œ í‘œì‹œ

      nextHours.forEach(entry => {
        const time = new Date(entry.time).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
        const temp = entry.data.instant.details.air_temperature;
        const symbol = entry.data.next_1_hours?.summary?.symbol_code || "clearsky_day";

        const slide = document.createElement("div");
        slide.className = "swiper-slide";
        slide.innerHTML = `
          <div class="slide-content">
            <p><strong>${time}</strong></p>
            <img src="./assets/icons/${symbol}.svg" alt="${symbol}" class="weather-icon"/>
            <p>${temp}â„ƒ</p>
          </div>
        `;
        forecastSlides.appendChild(slide);
      });

      new Swiper(".swiper", {
        slidesPerView: 2.5,
        spaceBetween: 10,
      });
    }

    // ì´ˆê¸° í˜¸ì¶œ
    fetchForecast();
  </script>
</body>
</html>